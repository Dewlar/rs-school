(()=>{"use strict";var t={557:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,'.about-container{position:fixed;width:100%;height:100%;display:flex;justify-content:center;align-items:center;padding:.7rem;transition:opacity .2s ease}.about-wrapper{display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1.5rem;max-width:60rem;width:100%;font-size:2rem;text-align:center;border:1px solid var(--border);border-radius:1rem;padding:1.5rem}.about-wrapper .author-link{color:#424040}.about-wrapper button{padding:.5rem 2.5rem;background-color:var(--button-bg-color);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:2rem;font-family:"Stylish", serif;transition:background-color 0.3s ease-in-out}.about-wrapper button:hover{background-color:var(--button-hover-bg-color)}.about-wrapper button:disabled{background-color:#b0b0b0;cursor:not-allowed}\n',""]);const a=o},625:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,".error-box{display:flex;flex-direction:column;gap:.5rem;position:absolute;top:4%;right:2%;z-index:1000}\n",""]);const a=o},527:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,".chat-container{position:fixed;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:.7rem;transition:opacity .2s ease}.chat-wrapper{display:flex;flex-direction:column;justify-content:space-between;gap:.8rem;max-width:100rem;width:100%;height:80vh}.chat-content{display:flex;justify-content:space-between;height:100%;max-height:68vh;gap:.8rem}\n",""]);const a=o},269:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,'.dialog-container{flex:1 1 auto;display:flex;flex-direction:column;justify-content:space-between;gap:.8rem;border-radius:.8rem;border:1px solid var(--border);width:100%;font-size:1.6rem;padding:.5rem}.dialog-header{display:flex;justify-content:space-around;padding:.5rem;border-bottom:1px solid var(--border);min-height:2.9rem}.dialog-content{display:flex;flex-direction:column;gap:0.3rem;padding:.5rem;height:100%;border:1px solid var(--border);overflow-y:scroll}.dialog-input{display:flex;gap:.8rem}.dialog-input .input{flex:1 1 auto;width:100%;font-size:2rem;font-family:"Stylish", serif;padding:.4rem 0.8rem;border:2px solid #ccc;border-radius:0.7rem;outline:none;transition:border-color 0.3s ease-in-out}.dialog-input .input:focus{border-color:#007bff}.dialog-input .submit-button{padding:.5rem 2.5rem;background-color:var(--button-bg-color);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:2rem;font-family:"Stylish", serif;transition:background-color 0.3s ease-in-out}.dialog-input .submit-button:hover{background-color:var(--button-hover-bg-color)}.dialog-input .submit-button:disabled{background-color:#b0b0b0;cursor:not-allowed}.initial-message{display:flex;justify-content:center;align-items:center;height:100%}\n',""]);const a=o},642:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,".footer{display:flex;justify-content:space-around;align-items:center;padding:.7rem;font-size:2rem;font-weight:bold;border:1px solid var(--border);border-radius:.8rem}\n",""]);const a=o},424:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,'.header{display:flex;justify-content:space-between;align-items:center;gap:.7rem;border-radius:.8rem;border:1px solid var(--border);font-size:2rem;font-weight:bold;padding:1rem .5rem}.header button{padding:.5rem 1rem;background-color:var(--button-bg-color);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:2rem;font-family:"Stylish", serif;transition:background-color 0.3s ease-in-out}.header button:hover{background-color:var(--button-hover-bg-color)}.header button:disabled{background-color:#b0b0b0;cursor:not-allowed}.title{flex:1 0 5rem;text-align:center}\n',""]);const a=o},128:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,".message-container{display:flex;width:100%}.message{display:flex;flex-direction:column;width:70%;background-color:#969696;padding:.1rem .5rem}.message-text{background-color:#d0cdcd}.message-header{font-size:1.4rem;display:flex;justify-content:space-between;padding:0 .5rem}.message-footer{font-size:1.4rem;display:flex;justify-content:space-between;padding:0 .5rem}\n",""]);const a=o},559:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,".list-item{display:flex;gap:.8rem;align-items:center;cursor:pointer;background-color:#878787;padding:.2rem .8rem;border-radius:.5rem}.list-item .dot{border-radius:50%;background-color:red;height:.6rem;width:.6rem}.list-item .green{background-color:green}\n",""]);const a=o},573:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,'.user-list{flex:2 2 30rem;display:flex;flex-direction:column;justify-content:flex-start;gap:.4rem;padding:.3rem;border-radius:.8rem;border:1px solid var(--border);font-size:1.6rem}.user-list .list{display:flex;flex-direction:column;justify-content:flex-start;gap:.4rem;list-style:none;overflow-y:scroll}.filter{width:100%;font-size:2rem;font-family:"Stylish", serif;padding:.4rem 0.8rem;border:2px solid #ccc;border-radius:0.7rem;outline:none;transition:border-color 0.3s ease-in-out}.filter:focus{border-color:#007bff}\n',""]);const a=o},693:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,".error-message{font-size:1.6rem;font-weight:bold;background-color:#e35656;color:#181616;padding:1rem 2rem;border-radius:.8rem;border:1px solid var(--border)}\n",""]);const a=o},417:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,'.login-container{position:fixed;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem;transition:opacity .2s ease}.login-form{display:flex;flex-direction:column;justify-content:center;gap:.5rem;margin:0 auto;padding:4rem 4rem;max-width:34rem;width:100%;border-radius:1rem;background-color:var(--transparent-bg);transition:opacity .2s ease}.login-form button{padding:1rem;background-color:var(--button-bg-color);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:2.4rem;font-family:"Stylish", serif;transition:background-color 0.3s ease-in-out}.login-form button:hover{background-color:var(--button-hover-bg-color)}.login-form button:disabled{background-color:#b0b0b0;cursor:not-allowed}input{font-size:2.4rem;font-family:"Stylish", serif;padding:0.8rem;border:2px solid #ccc;border-radius:0.7rem;outline:none;transition:border-color 0.3s ease-in-out}input.invalid{border-color:red}input:focus{border-color:#007bff}.login-error,.password-error{display:flex;align-items:center;font-size:1.4rem;font-family:"Stylish", serif;color:red;height:3.2rem}\n',""]);const a=o},353:(t,e,s)=>{s.d(e,{A:()=>a});var i=s(601),n=s.n(i),r=s(314),o=s.n(r)()(n());o.push([t.id,':root{--button-bg-color: #289bc4;--button-hover-bg-color: #302993;--transparent-bg: rgba(205, 214, 219, 0.5);--border: #969696}*{margin:0;padding:0;box-sizing:border-box}html{font-size:10px;scroll-behavior:smooth}body{background-color:burlywood;font-family:"Stylish", serif}.hidden{opacity:0;pointer-events:none}button{user-select:none}::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background-color:#bbb9b9}::-webkit-scrollbar-thumb{background-color:#807f7f;border-radius:6px}::-webkit-scrollbar-thumb:hover{background-color:#555}\n',""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var s="",i=void 0!==e[5];return e[4]&&(s+="@supports (".concat(e[4],") {")),e[2]&&(s+="@media ".concat(e[2]," {")),i&&(s+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),s+=t(e),i&&(s+="}"),e[2]&&(s+="}"),e[4]&&(s+="}"),s})).join("")},e.i=function(t,s,i,n,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var d=this[a][0];null!=d&&(o[d]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&o[h[0]]||(void 0!==r&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=r),s&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=s):h[2]=s),n&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=n):h[4]="".concat(n)),e.push(h))}},e}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function s(t){for(var s=-1,i=0;i<e.length;i++)if(e[i].identifier===t){s=i;break}return s}function i(t,i){for(var r={},o=[],a=0;a<t.length;a++){var d=t[a],l=i.base?d[0]+i.base:d[0],h=r[l]||0,c="".concat(l," ").concat(h);r[l]=h+1;var u=s(c),m={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==u)e[u].references++,e[u].updater(m);else{var g=n(m,i);i.byIndex=a,e.splice(a,0,{identifier:c,updater:g,references:1})}o.push(c)}return o}function n(t,e){var s=e.domAPI(e);return s.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;s.update(t=e)}else s.remove()}}t.exports=function(t,n){var r=i(t=t||[],n=n||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=s(r[o]);e[a].references--}for(var d=i(t,n),l=0;l<r.length;l++){var h=s(r[l]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}r=d}}},659:t=>{var e={};t.exports=function(t,s){var i=function(t){if(void 0===e[t]){var s=document.querySelector(t);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(t){s=null}e[t]=s}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,s)=>{t.exports=function(t){var e=s.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(s){!function(t,e,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,s)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var r=e[i]={id:i,exports:{}};return t[i](r,r.exports,s),r.exports}s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.nc=void 0,(()=>{var t=s(72),e=s.n(t),i=s(825),n=s.n(i),r=s(659),o=s.n(r),a=s(56),d=s.n(a),l=s(540),h=s.n(l),c=s(113),u=s.n(c),m=s(353),g={};g.styleTagTransform=u(),g.setAttributes=d(),g.insert=o().bind(null,"head"),g.domAPI=n(),g.insertStyleElement=h(),e()(m.A,g),m.A&&m.A.locals&&m.A.locals;class p{constructor(t,e){this.login=t,this.password=e}getLogin(){return this.login}getPassword(){return this.password}setLogin(t){this.login=t}setPassword(t){this.password=t}}class b{constructor(t){this.url=t,this.websocket=new WebSocket(t)}onOpen(t){this.websocket.onopen=t}onMessage(t){this.websocket.onmessage=t}send(t){this.websocket.send(t)}}const f="userData-dewlar";function v(t){return t.toString().padStart(2,"0")}class E{constructor(t,e){this.buttonName=t,this.className=e,this.button=document.createElement("button"),this.addButtonText(),this.addClass()}disable(){this.button.disabled=!0}enable(){this.button.disabled=!1}addButtonText(){this.button.textContent=this.buttonName}addClass(){this.className&&(this.button.className=this.className)}get node(){return this.button}}class y{constructor(t,e){this.type=t,this.className=e,this.input=document.createElement("input"),this.addType(),this.addClass()}addType(){this.input.type=this.type}addClass(){this.className&&(this.input.className=this.className)}enable(){this.input.disabled=!1}disable(){this.input.disabled=!0}get node(){return this.input}}var L=s(417),x={};x.styleTagTransform=u(),x.setAttributes=d(),x.insert=o().bind(null,"head"),x.domAPI=n(),x.insertStyleElement=h(),e()(L.A,x),L.A&&L.A.locals&&L.A.locals;class w{constructor(){this.container=document.createElement("div"),this.form=document.createElement("div"),this.inputLogin=new y("text"),this.inputPassword=new y("text"),this.inputLoginError=document.createElement("div"),this.inputPasswordError=document.createElement("div"),this.reviewerMessage=document.createElement("h1"),this.button=new E("Login"),this.button.disable(),this.setAttribute(),this.addEventListeners()}setAttribute(){this.container.className="login-container hidden",this.form.className="login-form",this.inputLogin.node.className="login",this.inputLogin.node.placeholder="Login",this.inputLoginError.className="login-error",this.inputLogin.node.value="",this.inputPassword.node.className="password",this.inputPassword.node.placeholder="Password",this.inputPassword.node.type="password",this.inputPasswordError.className="password-error",this.inputPassword.node.value="",this.reviewerMessage.innerHTML="I'm still working on making it better.<br>But check it out as is.<br>Thank you for waiting and helping me!",this.reviewerMessage.style.textAlign="center"}addEventListeners(){this.inputLogin.node.addEventListener("input",(()=>this.validateForm(this.inputLogin.node))),this.inputPassword.node.addEventListener("input",(()=>this.validateForm(this.inputPassword.node)))}validateForm(t){const[e,s]=this.validateName(t);t.classList.contains("login")&&(this.inputLogin.node.classList.toggle("invalid",!e),this.inputLoginError.textContent=e?"":s),t.classList.contains("password")&&(this.inputPassword.node.classList.toggle("invalid",!e),this.inputPasswordError.textContent=e?"":s),this.button.node.disabled=this.inputLogin.node.classList.contains("invalid")||this.inputPassword.node.classList.contains("invalid")||0===this.inputLogin.node.value.length||0===this.inputPassword.node.value.length}validateName(t){const e=t.value.trim();if(0===t.value.length)return[!1,"The field is required"];if(!/^[A-Z]/.test(t.value))return[!1,"First letter capitalize required"];if(/^[A-Z]{2,}/.test(t.value))return[!1,"One letter capitalized"];if(!/^[A-Z][a-z0-9-]*$/i.test(t.value))return[!1,"English letters or a hyphen"];if(t.classList.contains("login")){if(e.length<3)return[!1,"Minimum 3 symbols required"]}else if(e.length<4)return[!1,"Minimum 4 symbols required"];return/^[A-Z].*[a-z]$/.test(t.value)?[!0,""]:[!1,"First and last letters required"]}get formElements(){return{login:this.inputLogin.node,password:this.inputPassword.node,button:this.button.node,container:this.container}}render(){return this.form.append(this.inputLogin.node,this.inputLoginError,this.inputPassword.node,this.inputPasswordError,this.button.node),this.container.append(this.form,this.reviewerMessage),setTimeout((()=>this.container.classList.remove("hidden")),200),this.container}}var A=s(424),S={};S.styleTagTransform=u(),S.setAttributes=d(),S.insert=o().bind(null,"head"),S.domAPI=n(),S.insertStyleElement=h(),e()(A.A,S),A.A&&A.A.locals&&A.A.locals;class N{constructor(){this.header=document.createElement("div"),this.user=document.createElement("span"),this.title=document.createElement("span"),this.buttonLogout=new E("Logout"),this.buttonInfo=new E("Info"),this.setAttribute()}setAttribute(){this.header.className="header",this.user.className="user-name",this.title.className="title",this.title.textContent="Fun chat"}get headerElements(){return{buttonInfo:this.buttonInfo.node,buttonLogout:this.buttonLogout.node}}render(t){return this.user.textContent=`User: ${t}`,this.header.append(this.user,this.title,this.buttonInfo.node,this.buttonLogout.node),this.header}}var C=s(642),k={};k.styleTagTransform=u(),k.setAttributes=d(),k.insert=o().bind(null,"head"),k.domAPI=n(),k.insertStyleElement=h(),e()(C.A,k),C.A&&C.A.locals&&C.A.locals;class T{constructor(){this.footer=document.createElement("div"),this.logo=document.createElement("span"),this.author=document.createElement("span"),this.year=document.createElement("span"),this.setAttribute()}setAttribute(){this.footer.className="footer",this.logo.textContent="RSSchool",this.author.textContent="Dewlar",this.year.textContent="2024"}get headerElements(){return{footer:this.footer}}render(){return this.footer.append(this.logo,this.author,this.year),this.footer}}var M=s(573),I={};I.styleTagTransform=u(),I.setAttributes=d(),I.insert=o().bind(null,"head"),I.domAPI=n(),I.insertStyleElement=h(),e()(M.A,I),M.A&&M.A.locals&&M.A.locals;class P{constructor(){this.userList=document.createElement("div"),this.list=document.createElement("ul"),this.filter=new y("text"),this.setAttribute()}setAttribute(){this.userList.className="user-list",this.list.className="list",this.filter.node.className="filter",this.filter.node.placeholder="filter"}get userListElements(){return{userList:this.list,filter:this.filter.node}}render(){return this.userList.append(this.filter.node,this.list),this.userList}}var R=s(269),U={};U.styleTagTransform=u(),U.setAttributes=d(),U.insert=o().bind(null,"head"),U.domAPI=n(),U.insertStyleElement=h(),e()(R.A,U),R.A&&R.A.locals&&R.A.locals;class O{constructor(){this.container=document.createElement("div"),this.dialogHeader=document.createElement("div"),this.dialogContent=document.createElement("div"),this.dialogInput=document.createElement("div"),this.dialogContentMessage=document.createElement("div"),this.userName=document.createElement("span"),this.userStatus=document.createElement("span"),this.input=new y("text"),this.buttonSubmit=new E("Submit"),this.setAttribute()}setAttribute(){this.container.className="dialog-container",this.dialogHeader.className="dialog-header",this.dialogContent.className="dialog-content",this.dialogContentMessage.className="initial-message",this.dialogContentMessage.textContent="Please enter your first message",this.dialogInput.className="dialog-input",this.input.node.className="input",this.input.node.placeholder="message",this.input.disable(),this.buttonSubmit.node.className="submit-button",this.buttonSubmit.disable(),this.userStatus.className="user-status"}get dialogElements(){return{container:this.container,userName:this.userName,userStatus:this.userStatus,input:this.input,buttonSubmit:this.buttonSubmit,dialog:this.dialogContent,initialMessage:this.dialogContentMessage}}render(){return this.dialogHeader.append(this.userName,this.userStatus),this.dialogInput.append(this.input.node,this.buttonSubmit.node),this.container.append(this.dialogHeader,this.dialogContent,this.dialogInput),this.container}}var F=s(527),H={};H.styleTagTransform=u(),H.setAttributes=d(),H.insert=o().bind(null,"head"),H.domAPI=n(),H.insertStyleElement=h(),e()(F.A,H),F.A&&F.A.locals&&F.A.locals;class _{constructor(){this.container=document.createElement("div"),this.chat=document.createElement("div"),this.chatContent=document.createElement("div"),this.header=new N,this.footer=new T,this.userList=new P,this.dialog=new O,this.setAttribute()}setAttribute(){this.container.className="chat-container hidden",this.chatContent.className="chat-content",this.chat.className="chat-wrapper"}get chatElements(){return{header:this.header.headerElements,userList:this.userList.userListElements,dialog:this.dialog.dialogElements,container:this.container}}render(t){return this.chatContent.append(this.userList.render(),this.dialog.render()),this.chat.append(this.header.render(t),this.chatContent,this.footer.render()),this.container.append(this.chat),setTimeout((()=>this.container.classList.remove("hidden")),200),this.container}}var z=s(557),j={};j.styleTagTransform=u(),j.setAttributes=d(),j.insert=o().bind(null,"head"),j.domAPI=n(),j.insertStyleElement=h(),e()(z.A,j),z.A&&z.A.locals&&z.A.locals;class D{constructor(){this.container=document.createElement("div"),this.about=document.createElement("div"),this.title=document.createElement("h3"),this.message=document.createElement("p"),this.author=document.createElement("a"),this.buttonReturn=new E("Return"),this.setAttribute()}setAttribute(){this.container.className="about-container hidden",this.about.className="about-wrapper",this.title.className="about-title",this.title.textContent="Fun chat",this.message.textContent="The application is designed to demonstrate the Fun Chat task as part of the RSSchool JS/FE 2023Q3 course",this.author.textContent="Dewlar",this.author.href="https://github.com/Dewlar",this.author.className="author-link",this.author.target="_blank"}get aboutElements(){return{container:this.container,buttonReturn:this.buttonReturn.node}}render(){return this.about.append(this.title,this.message,this.author,this.buttonReturn.node),this.container.append(this.about),setTimeout((()=>this.container.classList.remove("hidden")),200),this.container}}var G=s(625),$={};$.styleTagTransform=u(),$.setAttributes=d(),$.insert=o().bind(null,"head"),$.domAPI=n(),$.insertStyleElement=h(),e()(G.A,$),G.A&&G.A.locals&&G.A.locals;var J=s(693),B={};B.styleTagTransform=u(),B.setAttributes=d(),B.insert=o().bind(null,"head"),B.domAPI=n(),B.insertStyleElement=h(),e()(J.A,B),J.A&&J.A.locals&&J.A.locals;class q{constructor(t){this.message=t,this.error=document.createElement("div"),this.setAttribute(),setTimeout((()=>this.error.remove()),2500)}setAttribute(){this.error.textContent=this.message,this.error.className="error-message"}get node(){return this.error}}var V=s(559),X={};X.styleTagTransform=u(),X.setAttributes=d(),X.insert=o().bind(null,"head"),X.domAPI=n(),X.insertStyleElement=h(),e()(V.A,X),V.A&&V.A.locals&&V.A.locals;class Z{constructor(t,e){this.login=t,this.isLogined=e,this.li=document.createElement("li"),this.dot=document.createElement("div"),this.userLogin=document.createElement("span"),this.setAttribute(),this.changeOnlineStatus(this.isLogined)}setAttribute(){this.li.className="list-item",this.dot.className="dot",this.userLogin.className="user-login",this.userLogin.textContent=`${this.login}`,this.li.setAttribute("data-login",this.login)}setIsLogined(t){this.isLogined=t,this.changeOnlineStatus(this.isLogined)}changeOnlineStatus(t){t?this.dot.classList.add("green"):this.dot.classList.remove("green")}get elements(){return{li:this.li,dot:this.dot,userLogin:this.userLogin,isLogined:this.isLogined}}render(){return this.li.append(this.dot,this.userLogin),this.li}}var W=s(128),K={};K.styleTagTransform=u(),K.setAttributes=d(),K.insert=o().bind(null,"head"),K.domAPI=n(),K.insertStyleElement=h(),e()(W.A,K),W.A&&W.A.locals&&W.A.locals;class Q{constructor(t,e,s,i,n,r,o,a){this.id=t,this.container=document.createElement("div"),this.message=document.createElement("div"),this.header=document.createElement("div"),this.messageText=document.createElement("div"),this.footer=document.createElement("div"),this.from=document.createElement("span"),this.time=document.createElement("span"),this.delivered=document.createElement("span"),this.readed=document.createElement("span"),this.edited=document.createElement("span"),this.setAttribute(e,i,n,r,o,a)}setAttribute(t,e,s,i,n,r){this.container.className="message-container",this.message.className="message",this.header.className="message-header",this.footer.className="message-footer",this.messageText.className="message-text",this.from.textContent=t,this.time.textContent=e,this.messageText.textContent=s,this.delivered.textContent=i?"delivered":"not delivered",this.readed.textContent=n?"readed":"not readed",this.edited.textContent=r?"edited":""}get elements(){return{id:this.id,container:this.container,edited:this.edited,readed:this.readed,delivered:this.delivered,from:this.from,time:this.time,messageText:this.messageText,message:this.message}}render(){return this.header.append(this.from,this.time),this.footer.append(this.readed,this.edited,this.delivered),this.message.append(this.header,this.messageText,this.footer),this.container.append(this.message),this.container}}const Y=new class{constructor(){this.loginForm=new w,this.currentUser=null,this.sendTo=null,this.websocketManager=new b("ws://localhost:4000"),this.sessionStorageData=sessionStorage.getItem(f),this.user=new p("",""),this.chat=new _,this.about=new D,this.addEventListeners(),this.errorBox=document.createElement("div"),this.errorBox.className="error-box",document.body.append(this.errorBox),this.usersList=[],this.historyMessages=[]}init(){var t;this.websocketManager.onOpen((()=>{console.log("WebSocket opened"),this.loginFormSubmit()}));const{login:e="",password:s=""}=JSON.parse(null!==(t=this.sessionStorageData)&&void 0!==t?t:"{}");this.user.setLogin(e),this.user.setPassword(s),this.user.getPassword()?document.body.append(this.chat.render(this.user.getLogin())):document.body.append(this.loginForm.render()),this.websocketManager.onMessage((t=>{const{type:e,payload:s}=JSON.parse(t.data);switch(e){case"USER_LOGIN":s.user.isLogined&&this.loginUserApply();break;case"USER_LOGOUT":s.user.isLogined||this.logoutUserApply();break;case"USER_ACTIVE":console.log("active*****: ",e,s.users),this.chat.chatElements.userList.userList.append(...this.createUserList(s.users)),this.usersList.forEach((t=>t.setIsLogined(!0)));break;case"USER_INACTIVE":console.log("inActive*****:",e,s.users),this.chat.chatElements.userList.userList.append(...this.createUserList(s.users));break;case"USER_EXTERNAL_LOGIN":if(console.log("USER_EXTERNAL_LOGIN!!!",s.user.login),-1===this.usersList.findIndex((t=>t.elements.userLogin.textContent===s.user.login))){const t=new Z(s.user.login,s.user.isLogined);this.usersList.push(t),this.chat.chatElements.userList.userList.innerHTML="",this.chat.chatElements.userList.userList.append(...this.updateUsersList(this.usersList))}this.usersList.forEach((t=>{t.elements.userLogin.textContent===s.user.login&&t.setIsLogined(!0),this.chat.chatElements.dialog.userName.textContent===s.user.login&&this.updateChat(s.user.login)}));break;case"USER_EXTERNAL_LOGOUT":console.log("USER_EXTERNAL_LOGOUT!!!",s.user.login),this.usersList.forEach((t=>{t.elements.userLogin.textContent===s.user.login&&t.setIsLogined(!1),this.chat.chatElements.dialog.userName.textContent===s.user.login&&this.updateChat(s.user.login)}));break;case"MSG_SEND":this.createMessage(s.message),this.updateChat(this.chat.chatElements.dialog.userName.textContent?this.chat.chatElements.dialog.userName.textContent:"");break;case"MSG_FROM_USER":this.historyMessages=[],s.messages.forEach((t=>this.createMessage(t))),this.updateChat(this.chat.chatElements.dialog.userName.textContent?this.chat.chatElements.dialog.userName.textContent:"");break;case"ERROR":this.errorBox.append(new q(s.error).node)}}))}createMessage(t){const{id:e,from:s,datetime:i,text:n,status:r,to:o}=t,a=new Q(e,s,o,function(t){const e=new Date(t);return`${v(e.getDate())}.${v(e.getMonth()+1)}.${e.getFullYear()}, ${v(e.getHours())}:${v(e.getMinutes())}:${v(e.getSeconds())}`}(i),n,r.isDelivered,r.isReaded,r.isEdited);s===this.user.getLogin()?(a.elements.container.style.justifyContent="flex-end",a.elements.message.style.borderRadius="1rem 0 1rem 1rem"):(a.elements.container.style.justifyContent="flex-start",a.elements.message.style.borderRadius="0 1rem 1rem 1rem"),this.historyMessages.push(a)}createUserList(t){const e=t.filter((t=>t.login!==this.user.getLogin())).map((t=>new Z(t.login,t.isLogined)));return this.usersList.push(...e),this.updateUsersList(e)}addEventListeners(){this.loginForm.formElements.button.addEventListener("click",this.loginFormSubmit.bind(this)),this.chat.chatElements.header.buttonLogout.addEventListener("click",this.logoutHandler.bind(this)),this.chat.chatElements.header.buttonInfo.addEventListener("click",this.aboutHandler.bind(this)),this.about.aboutElements.buttonReturn.addEventListener("click",this.aboutReturnHandler.bind(this)),this.chat.chatElements.userList.filter.addEventListener("input",this.userFilterHandler.bind(this)),this.chat.chatElements.dialog.buttonSubmit.node.addEventListener("click",this.sendMessageSubmit.bind(this)),this.chat.chatElements.dialog.input.node.addEventListener("keypress",this.sendMessageSubmit.bind(this)),this.chat.chatElements.dialog.input.node.addEventListener("click",this.selectUser.bind(this)),this.chat.chatElements.dialog.container.addEventListener("click",this.selectUser.bind(this))}userFilterHandler(){const t=this.chat.chatElements.userList.filter.value.toLowerCase(),e=this.usersList.filter((e=>e.elements.userLogin.textContent?e.elements.userLogin.textContent.toLowerCase().includes(t):""));this.chat.chatElements.userList.userList.innerHTML="",this.chat.chatElements.userList.userList.append(...this.updateUsersList(e))}aboutReturnHandler(){this.about.aboutElements.container.classList.add("hidden"),setTimeout((()=>{this.about.aboutElements.container.remove(),document.body.append(this.chat.render(this.user.getLogin())),this.updateChat("")}),200)}aboutHandler(){this.chat.chatElements.container.classList.add("hidden"),setTimeout((()=>{this.chat.chatElements.container.remove(),document.body.append(this.about.render())}),200),this.cleanInput()}logoutHandler(){this.websocketManager.send(JSON.stringify({id:"1",type:"USER_LOGOUT",payload:{user:this.user}}))}logoutUserApply(){sessionStorage.removeItem(f),this.chat.chatElements.userList.userList.innerHTML="",this.updateChat(""),this.chat.chatElements.container.classList.add("hidden"),setTimeout((()=>{this.chat.chatElements.container.remove(),document.body.append(this.loginForm.render())}),200)}loginFormSubmit(t){t&&t.preventDefault();const e=this.loginForm.formElements.login.value.trim(),s=this.loginForm.formElements.password.value.trim();e&&s&&(this.user.setLogin(e),this.user.setPassword(s)),this.user.getLogin()&&this.user.getPassword()&&this.websocketManager.send(JSON.stringify({id:"1",type:"USER_LOGIN",payload:{user:this.user}}))}loginUserApply(){sessionStorage.setItem(f,JSON.stringify(this.user)),this.websocketManager.send(JSON.stringify({id:"1",type:"USER_ACTIVE",payload:null})),this.websocketManager.send(JSON.stringify({id:"1",type:"USER_INACTIVE",payload:null})),this.loginForm.formElements.container.classList.add("hidden"),this.cleanInput(),setTimeout((()=>{this.loginForm.formElements.container.remove(),document.body.append(this.chat.render(this.user.getLogin()))}),200)}updateUsersList(t){const e=t.map((t=>t.render()));return e.forEach((t=>t.addEventListener("click",this.selectUser.bind(this)))),e}selectUser(t){let e,s;t?(e=t.currentTarget,s=e.getAttribute("data-login")||this.chat.chatElements.dialog.userName.textContent):s=this.chat.chatElements.dialog.userName.textContent?this.chat.chatElements.dialog.userName.textContent:"",this.historyMessages.forEach((t=>{t.elements.from.textContent!==this.user.getLogin()&&this.websocketManager.send(JSON.stringify({id:"1",type:"MSG_READ",payload:{message:{id:t.elements.id}}}))})),this.chat.chatElements.dialog.dialog.innerHTML="",s&&(this.websocketManager.send(JSON.stringify({id:"1",type:"MSG_FROM_USER",payload:{user:{login:`${s}`}}})),this.updateChat(s)),this.cleanInput()}updateChat(t){if(t){const[e]=this.usersList.filter((e=>e.elements.userLogin.textContent===t));this.chat.chatElements.dialog.userName.textContent=t,e.elements.isLogined?(this.chat.chatElements.dialog.userStatus.textContent="online",this.chat.chatElements.dialog.userStatus.style.color="green"):(this.chat.chatElements.dialog.userStatus.textContent="offline",this.chat.chatElements.dialog.userStatus.style.color="red"),this.chat.chatElements.dialog.input.enable(),this.chat.chatElements.dialog.buttonSubmit.enable(),this.chat.chatElements.dialog.dialog.innerHTML="",this.chat.chatElements.dialog.dialog.append(...this.historyMessages.map((t=>t.render()))),this.chat.chatElements.dialog.dialog.scrollTo(0,this.chat.chatElements.dialog.dialog.scrollHeight)}else this.chat.chatElements.dialog.input.disable(),this.chat.chatElements.dialog.buttonSubmit.disable(),this.chat.chatElements.dialog.userName.textContent="",this.chat.chatElements.dialog.userStatus.textContent="",this.chat.chatElements.dialog.dialog.innerHTML=""}sendMessageHandler(){const t=this.chat.chatElements.dialog.input.node.value;t&&this.websocketManager.send(JSON.stringify({id:"1",type:"MSG_SEND",payload:{message:{to:`${this.chat.chatElements.dialog.userName.textContent}`,text:`${t}`}}})),this.cleanInput()}sendMessageSubmit(t){t&&t instanceof KeyboardEvent&&"Enter"===t.key&&this.sendMessageHandler(),t&&t instanceof MouseEvent&&this.sendMessageHandler()}cleanInput(){this.chat.chatElements.dialog.input.node.value="",this.loginForm.formElements.login.value="",this.loginForm.formElements.password.value=""}};Y.init()})()})();