(()=>{"use strict";var t={625:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,'.page-buttons-container{display:flex;justify-content:space-between;padding:1rem 0;width:30rem}.page-button{font-family:"Stylish", serif;font-size:1.6rem;font-weight:600;text-transform:uppercase;padding:.8rem 3rem;border:none;border-radius:.5rem;background-color:#fff;cursor:pointer;transition:.2s}.page-button:hover{color:#fff;background-color:blueviolet}.page-button.active{color:#fff;background-color:blueviolet}\n',""]);const a=o},721:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,'.car-item{display:flex;flex-wrap:wrap;column-gap:1rem;box-shadow:1px 1px 3px dimgray;padding:.7rem;border-radius:.3rem;row-gap:.7rem}.car-item h4{padding:.1rem 1rem;margin-left:1.5rem;border:1px solid #000;border-radius:4px;font-size:1.6rem;user-select:none}.car-item .car-road{display:flex;width:100%;align-items:center;column-gap:1rem}.car-item .road{border-bottom:3px dashed dimgray;position:relative;display:flex;width:92%}.car-item .car svg{width:50px;height:28px}.car-item .car{display:flex;align-items:flex-end;position:relative;bottom:-5px}.car-item .finish svg{width:30px;height:30px}.car-item .finish{position:absolute;width:30px;height:30px;right:35px}.car-item .start{padding:2px 7px;color:#fff;background-color:blueviolet;cursor:pointer;transition:.3s}.car-item .start:hover{transform:scale(1.05)}.car-item .stop{padding:2px 7px;color:#fff;background-color:royalblue;cursor:pointer;transition:.3s}.car-item .stop:hover{transform:scale(1.05)}.car-item .stop:disabled{transform:scale(0.95);background-color:dimgray;cursor:not-allowed;color:#fff}.car-item button{font-family:"Stylish", serif;font-size:1.6rem;border:none;padding:0 1rem;font-weight:600;border-radius:4px;color:#2b2b2b;background-color:#fff;cursor:pointer;transition:.3s;height:25px}.car-item button:hover{background-color:mediumspringgreen;box-shadow:0 0 0;color:#2b2b2b}\n',""]);const a=o},493:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,".garage-data-counter{display:flex;justify-content:flex-start;gap:3rem;margin-top:1rem;width:35rem;font-size:1.6rem;user-select:none}.garage-data-counter p{padding:.8rem 2.2rem;border:1px solid rgba(255,255,255,0.5);border-radius:4px;color:#000;font-weight:bold}.garage-list{display:flex;flex-direction:column;border:1px solid rgba(255,255,255,0.5);padding:1rem;margin:1rem auto 1.5rem;border-radius:.3rem;row-gap:1rem}\n",""]);const a=o},245:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,".modal{display:flex;justify-content:center;align-items:center;position:fixed;top:0;left:0;background-color:rgba(120,120,120,0.4);width:100%;height:100%;z-index:100}.modal-title{font-size:6vw;margin:0 auto;color:#f4ca16;padding:20px 15px;border-radius:25%;background-color:#fff;border:3px solid dimgray;text-shadow:0 0 3px black}\n",""]);const a=o},475:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,'.page-change-button{display:flex;justify-content:start;margin-top:1rem;gap:1.75rem}.page-change-button .prev:disabled,.page-change-button .next:disabled{background-color:dimgray;color:#fff;transform:scale(0.95);cursor:not-allowed}.page-change-button .prev:disabled:hover,.page-change-button .next:disabled:hover{background-color:dimgray}.page-change-button button{font-family:"Stylish", serif;font-size:1.8rem;font-weight:700;text-transform:uppercase;padding:.5rem 1.8rem;border:0;border-radius:4px;background-color:#fff;cursor:pointer;transition:.3s}.page-change-button button:hover{transform:scale(1.05)}.page-change-button button.next:hover,.page-change-button button.prev:hover{background-color:blueviolet;color:#fff}\n',""]);const a=o},353:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(601),i=n.n(r),s=n(314),o=n.n(s)()(i());o.push([t.id,'*{margin:0;padding:0;box-sizing:border-box}html{font-size:10px;font-family:"Stylish", serif}body{background-color:#939393;padding:0 1rem}\n',""]);const a=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var d=0;d<t.length;d++){var l=[].concat(t[d]);r&&o[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var c=t[a],d=r.base?c[0]+r.base:c[0],l=s[d]||0,h="".concat(d," ").concat(l);s[d]=l+1;var u=n(h),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var m=i(p,r);r.byIndex=a,e.splice(a,0,{identifier:h,updater:m,references:1})}o.push(h)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=r(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var c=r(t,i),d=0;d<s.length;d++){var l=n(s[d]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}s=c}}},659:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={id:r,exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{var t=n(72),e=n.n(t),r=n(825),i=n.n(r),s=n(659),o=n.n(s),a=n(56),c=n.n(a),d=n(540),l=n.n(d),h=n(113),u=n.n(h),p=n(353),m={};m.styleTagTransform=u(),m.setAttributes=c(),m.insert=o().bind(null,"head"),m.domAPI=i(),m.insertStyleElement=l(),e()(p.A,m),p.A&&p.A.locals&&p.A.locals;var g=n(625),f={};f.styleTagTransform=u(),f.setAttributes=c(),f.insert=o().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=l(),e()(g.A,f),g.A&&g.A.locals&&g.A.locals;class v{constructor(t,e){this.button=document.createElement("button"),this.addButtonText(t),e&&this.addClass(e)}disabled(){this.button.disabled=!0}enabled(){this.button.disabled=!1}addButtonText(t){this.button.textContent=t}addClass(t){this.button.className=t}get node(){return this.button}}var b=n(493),y={};y.styleTagTransform=u(),y.setAttributes=c(),y.insert=o().bind(null,"head"),y.domAPI=i(),y.insertStyleElement=l(),e()(b.A,y),b.A&&b.A.locals&&b.A.locals;const x="http://localhost:3100";var w=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((r=r.apply(t,e||[])).next())}))};const E=`${x}/garage`,k=`${x}/engine`,A=`${x}/winners`,C=(t,...e)=>w(void 0,[t,...e],void 0,(function*(t,e=7){try{const n=yield fetch(`${E}?_page=${t}&_limit=${e}`),r=yield n.json();return{items:yield Promise.all(r),count:n.headers.get("X-Total-Count")}}catch(t){throw t instanceof Error?new Error(`Failed to fetch/get cars: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})),L=(t,e)=>w(void 0,void 0,void 0,(function*(){try{const n=yield fetch(`${k}?id=${t}&status=${e}`,{method:"PATCH"});return yield n.json()}catch(t){throw t instanceof Error?new Error(`Failed to update engine status: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})),S=(t,...e)=>w(void 0,[t,...e],void 0,(function*(t,e="time",n="ASC",r=10){try{const i=yield fetch(`${A}/?_page=${t}&_limit=${r}&_sort=${e}&_order=${n}`);return{result:yield i.json(),totalCount:i.headers.get("X-Total-Count")||"0"}}catch(t){throw t instanceof Error?new Error(`Failed to fetch/get winners: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}}));class ${constructor(){this.container=document.createElement("div"),this.container.className="garage-data-counter",this.pageNumber=document.createElement("p"),this.carCount=document.createElement("p")}updateState(t,e=0){this.pageNumber.innerHTML=`Page: ${t}`,this.carCount.innerHTML=`Total cars in garage: ${e}`}render(){return this.container.append(this.pageNumber,this.carCount),this.container}}var B=n(721),N={};N.styleTagTransform=u(),N.setAttributes=c(),N.insert=o().bind(null,"head"),N.domAPI=i(),N.insertStyleElement=l(),e()(B.A,N),B.A&&B.A.locals&&B.A.locals;class T{constructor(t){this.container=document.createElement("div"),this.road=document.createElement("div"),this.car=document.createElement("div"),this.finish=document.createElement("div"),this.start=new v("start","start"),this.stop=new v("stop","stop"),this.addAttribute(t),this.road.append(this.car,this.finish),this.container.append(this.start.node,this.stop.node,this.road)}addAttribute(t){this.container.className="car-road",this.road.className="road",this.car.className="car",this.car.innerHTML=function(t){return`\n<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: Adobe Illustrator 23.0.3, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --\x3e\n<svg version="1.1" id="Icons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve">\n<style type="text/css">\n\t.st0{fill:none;stroke:${t};stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;}\n\t.st1{fill:none;stroke:#000000;stroke-width:2;stroke-linejoin:round;stroke-miterlimit:10;}\n</style>\n<circle class="st0" cx="7" cy="23" r="3"/>\n<circle class="st0" cx="23" cy="23" r="3"/>\n<line class="st0" x1="28" y1="19" x2="30" y2="19"/>\n<line class="st0" x1="4" y1="16" x2="24" y2="16"/>\n<line class="st0" x1="13" y1="10" x2="10" y2="16"/>\n<path class="st0" d="M26,23h4c0.6,0,1-0.4,1-1v-2c0-2.2-1.8-4-4-4h-3l-3.8-4.6c-0.8-0.9-1.9-1.4-3.1-1.4H9.5c-1.5,0-2.9,0.9-3.6,2.2\n\tL4,16H3c-1.1,0-2,0.9-2,2v4c0,0.6,0.4,1,1,1h2"/>\n<line class="st0" x1="10" y1="23" x2="20" y2="23"/>\n</svg>\n`}(t),this.finish.className="finish",this.finish.innerHTML='\n<?xml version="1.0" encoding="iso-8859-1"?>\n<svg height="800px" width="800px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" \n\t viewBox="0 0 20.695 20.695" xml:space="preserve">\n<g>\n\t<path style="fill:#030104;" d="M10.099,3.996l0.898,1.453L9.372,6.64L8.447,5.144L7.141,5.952L6.332,4.645L7.64,3.836l0.809,1.306\n\t\tL10.099,3.996z M10.181,7.946L9.374,6.64L8.066,7.448l0.807,1.306L10.181,7.946z M17.667,5.115l-0.144,0.312\n\t\tc-0.26,1.43-1.146,2.388-1.805,2.795c-1.426,0.881-2.903,0.353-2.964,0.331c-0.958-0.203-1.814-0.087-2.52,0.35\n\t\tC8.926,9.712,8.553,11.37,8.55,11.389l-0.087,0.407l5.182,8.378l-0.839,0.521L3.577,5.775C3.4,5.845,3.193,5.787,3.089,5.619\n\t\tC2.971,5.428,3.03,5.18,3.22,5.062l0.694-0.428C4.102,4.516,4.352,4.575,4.47,4.766C4.568,4.925,4.537,5.12,4.414,5.251\n\t\tl0.249,0.404l0.006-0.013C5.211,4.327,5.901,3.404,6.719,2.9c1.484-0.917,2.84-0.154,2.897-0.121\n\t\tc1.16,0.676,1.986,0.458,2.474,0.156c0.209-0.13,0.319-0.256,0.319-0.256c1.146-1.005,1.607-2.143,1.81-2.559\n\t\tc0.202-0.415,0.563,0.383,0.563,0.383L17.667,5.115z M14.049,1.209l0.209,0.338l0.513-0.4l-0.41-0.662\n\t\tC14.277,0.652,14.201,0.956,14.049,1.209z M8.442,10.6l-0.235,0.146l0.111,0.177C8.35,10.83,8.393,10.717,8.442,10.6z\n\t\t M12.691,8.188l-0.18-0.291l-0.176,0.238C12.452,8.148,12.572,8.164,12.691,8.188z M13.958,7.312L13.251,6.17l1.433-1.01\n\t\tl-0.809-1.306l-1.431,1.012l-0.839-1.355c-0.168,0.04-0.356,0.064-0.563,0.062L10.1,3.997L9.582,3.163\n\t\tC9.534,3.136,9.487,3.112,9.438,3.084C9.422,3.075,9.297,3.005,9.092,2.937L7.639,3.836L7.158,3.061\n\t\tC7.075,3.1,6.99,3.147,6.904,3.2C6.569,3.407,6.259,3.697,5.97,4.06l0.361,0.586L5.184,5.354C5.132,5.465,5.081,5.575,5.031,5.693\n\t\tl0.707,1.126L7.14,5.952l0.926,1.495L6.675,8.308l0.817,1.3l1.381-0.854l0.351,0.565c0.227-0.264,0.497-0.514,0.825-0.718\n\t\tc0.132-0.08,0.269-0.147,0.408-0.21l-0.276-0.446l1.632-1.176l-0.816-1.32l1.445-0.583l0.807,1.305l-1.435,0.598l0.669,1.081\n\t\tL13.958,7.312z M17.147,4.951l-0.021-0.034l-0.502,0.456l-0.698-1.126l0.526-0.409l-0.871-1.394L15.117,2.94l-0.858-1.39\n\t\tl-0.757,0.468c-0.133,0.176-0.281,0.349-0.438,0.519l0.812,1.315l1.243-0.913l0.807,1.308l-1.241,0.912l0.707,1.142l-1.396,1.072\n\t\tl0.576,0.93c0.312-0.065,0.639-0.182,0.961-0.381c0.205-0.127,0.397-0.282,0.576-0.461l-0.717-1.159l1.232-0.929l0.41,0.663\n\t\tL17.147,4.951z"/>\n</g>\n</svg>\n',this.stop.disabled()}get getNode(){return{start:this.start.node,stop:this.stop.node,car:this.car,line:this.road}}get getStartStopButton(){return{start:this.start,stop:this.stop}}render(){return this.container}}var R=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((r=r.apply(t,e||[])).next())}))};class M{constructor(t,e,n,r,i){this.car=t,this.renderList=e,this.checkRace=n,this.winner=r,this.poorRun=i,this.container=document.createElement("div"),this.container.className="car-item",this.title=document.createElement("h4"),this.title.textContent=t.name,this.id=t.id,this.remove=new v("remove"),this.select=new v("select"),this.carRoad=new T(t.color),this.state={stateCar:"stopped",distance:0,bool:!1,check:!1,btnStop:!0},this.data=t,this.createCar()}startCar(){return R(this,void 0,void 0,(function*(){const t=this.carRoad.getNode.line.clientWidth;this.remove.disabled(),this.state.check=!0,this.state.btnStop=!0,this.carRoad.getStartStopButton.start.disabled(),this.carRoad.getStartStopButton.stop.enabled();const e=yield L(this.id,"started");this.state.stateCar="started";const n=(r=this.id,w(void 0,void 0,void 0,(function*(){try{return yield fetch(`${k}?id=${r}&status=drive`,{method:"PATCH"})}catch(t){throw t instanceof Error?new Error(`Failed to update drive state: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})));var r;this.state.bool=!0;const i=()=>R(this,void 0,void 0,(function*(){var r;this.checkRace(),this.state.distance+=e.velocity/((r=t)<325?150:r<600?120:r<900?50:r>900?20:0),this.carRoad.getNode.car.style.left=`${this.state.distance}px`,this.checkRaceStart(),this.state.distance<t-50&&this.state.bool&&"started"===this.state.stateCar&&(this.state.distance>t-55&&(this.winner.viewWinner(this.data,e.velocity),this.winner.setState=!1),requestAnimationFrame(i)),500===(yield n).status&&(this.poorRun(),this.state.check&&this.carRoad.getStartStopButton.stop.enabled(),this.state.bool=!1,this.state.check=!1,this.remove.enabled())}));requestAnimationFrame(i)}))}checkRaceStart(){this.state.check&&(this.winner.state.race?(this.carRoad.getStartStopButton.stop.disabled(),this.remove.disabled()):(this.carRoad.getStartStopButton.stop.enabled(),this.remove.enabled(),this.state.check=!1))}stopCar(){return R(this,void 0,void 0,(function*(){this.state.btnStop=!1,this.carRoad.getStartStopButton.stop.disabled(),yield L(this.id,"stopped"),this.state.stateCar="stopped",yield this.checkRace(),this.state.distance=0,this.state.check=!1,this.state.bool=!1,this.carRoad.getStartStopButton.start.enabled(),this.state.btnStop||(this.state.distance=0,this.carRoad.getStartStopButton.stop.disabled(),this.carRoad.getStartStopButton.start.enabled()),this.carRoad.getNode.car.style.left=`${this.state.distance}%`}))}removeBtn(){return R(this,void 0,void 0,(function*(){var t,e;this.remove.disabled(),this.select.disabled(),(yield S(1,"id","ASC",1e3)).result.find((t=>t.id===this.id))&&(yield(t=this.id,w(void 0,void 0,void 0,(function*(){try{yield fetch(`${A}/${t}`,{method:"DELETE"})}catch(t){throw t instanceof Error?new Error(`Failed to delete winner: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})))),yield this.stopCar(),yield(e=this.id,w(void 0,void 0,void 0,(function*(){try{yield fetch(`${E}/${e}`,{method:"DELETE"})}catch(t){throw t instanceof Error?new Error(`Failed to delete car: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}}))),yield this.renderList(this.id)}))}updateBtn(){}addListeners(){this.carRoad.getNode.start.addEventListener("click",(()=>this.startCar())),this.carRoad.getNode.stop.addEventListener("click",(()=>this.stopCar())),this.remove.node.addEventListener("click",(()=>this.removeBtn())),this.select.node.addEventListener("click",(()=>this.updateBtn()))}createCar(){this.addListeners(),this.container.append(this.remove.node,this.select.node,this.title,this.carRoad.render())}render(){return this.container}}var P=n(245),z={};z.styleTagTransform=u(),z.setAttributes=c(),z.insert=o().bind(null,"head"),z.domAPI=i(),z.insertStyleElement=l(),e()(P.A,z),P.A&&P.A.locals&&P.A.locals;var j=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((r=r.apply(t,e||[])).next())}))};class F{constructor(){this.container=document.createElement("div"),this.title=document.createElement("h1"),this.state={race:!1},this.winners=[]}viewWinner(t,e){return j(this,void 0,void 0,(function*(){if(this.state.race){this.removeModal();const i=+(e/10).toFixed(2);if(console.log(i,e),this.container.className="modal",this.title.className="modal-title",this.title.textContent=`${t.name} wins! With ${i}s!`,this.container.append(this.title),yield this.getWinners(),this.winners.includes(t.id)){const e=yield(r=t.id,w(void 0,void 0,void 0,(function*(){try{const t=yield fetch(`${A}/${r}`);return yield t.json()}catch(t){throw t instanceof Error?new Error(`Failed to fetch/get winner: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})));yield(n={id:t.id,time:e.time<i?e.time:i,wins:e.wins+=1},w(void 0,void 0,void 0,(function*(){try{yield fetch(`${A}/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(t){throw t instanceof Error?new Error(`Failed to update winner: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})))}else yield(t=>w(void 0,void 0,void 0,(function*(){try{yield fetch(`${A}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch(t){throw t instanceof Error?new Error(`Failed to create winner: ${t.message}`):new Error(`An unknown error occurred: ${t}`)}})))({id:t.id,time:i,wins:1})}var n,r;this.state.race=!1}))}getWinners(){return j(this,void 0,void 0,(function*(){const t=yield S(1,"id","ASC",1e3);this.winners=t.result.map((t=>t.id))}))}removeModal(){this.container.addEventListener("click",(()=>{this.container.className="",this.container.innerHTML=""}))}set setState(t){this.state.race=t}render(){return this.container}}var H=n(475),I={};I.styleTagTransform=u(),I.setAttributes=c(),I.insert=o().bind(null,"head"),I.domAPI=i(),I.insertStyleElement=l(),e()(H.A,I),H.A&&H.A.locals&&H.A.locals;class W{constructor(){this.container=document.createElement("div"),this.container.className="page-change-button",this.prev=new v("prev","prev"),this.next=new v("next","next")}get getNode(){return{prev:this.prev.node,next:this.next.node}}get getButton(){return{prev:this.prev,next:this.next}}render(){return this.container.append(this.prev.node,this.next.node),this.container}}var _=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((r=r.apply(t,e||[])).next())}))};class O{constructor(){this.garage=document.createElement("div"),this.garage.className="garage",this.page=1,this.count=0,this.data=new $,this.list=document.createElement("div"),this.list.className="garage-list",this.cars=[],this.prevNextBtn=new W,this.renderList(),this.modalWinner=new F,this.addListeners()}renderList(t){return _(this,void 0,void 0,(function*(){this.garageView();const e=yield C(this.page),n=this.cars.map((t=>t.id));t&&(this.cars=this.cars.filter((e=>e.id!==t))),this.cars.length<7&&(e.items.forEach((t=>{n.includes(t.id)||this.cars.push(new M(t,this.renderList.bind(this),this.checkRaceReset.bind(this),this.modalWinner,this.poorRun.bind(this)))})),this.list.innerHTML="",this.cars.forEach((t=>this.list.append(t.render())))),this.checkCarsCount()}))}checkRaceReset(){return _(this,void 0,void 0,(function*(){this.modalWinner.state.race}))}pagePrevNext(t){return _(this,void 0,void 0,(function*(){this.prevNextBtn.getButton.prev.disabled(),this.prevNextBtn.getButton.next.disabled(),"next"===t?this.page+=1:this.page-=1,this.cars.forEach((t=>_(this,void 0,void 0,(function*(){yield t.stopCar()})))),this.cars.length=0,yield this.renderList(),this.checkCarsCount()}))}checkCarsCount(){this.page<=1?this.prevNextBtn.getButton.prev.disabled():this.prevNextBtn.getButton.prev.enabled(),this.count/7<=this.page?this.prevNextBtn.getButton.next.disabled():this.prevNextBtn.getButton.next.enabled()}poorRun(){0===this.cars.filter((t=>t.state.check)).length&&(this.modalWinner.setState=!1)}garageView(){return _(this,void 0,void 0,(function*(){const t=yield C(this.page);t.count&&(this.data.updateState(this.page,Number(t.count)),this.count=Number(t.count))}))}addListeners(){this.prevNextBtn.getNode.next.addEventListener("click",(()=>this.pagePrevNext("next"))),this.prevNextBtn.getNode.prev.addEventListener("click",(()=>this.pagePrevNext("prev")))}render(){return this.garageView(),this.garage.append(this.modalWinner.render(),this.data.render(),this.list,this.prevNextBtn.render()),this.garage}}(new class{constructor(){this.main=document.createElement("main"),this.page=document.createElement("div"),this.buttonContainer=document.createElement("div"),this.garageButton=new v("garage","page-button"),this.winnerButton=new v("winners","page-button"),this.garage=new O}addBtnListeners(){this.garageButton.node.addEventListener("click",(()=>this.renderGarage())),this.winnerButton.node.addEventListener("click",(()=>this.renderWinner()))}renderGarage(){this.main.innerHTML="",this.main.append(this.garage.render()),this.garageButton.node.classList.add("active"),this.winnerButton.node.classList.remove("active")}renderWinner(){this.main.innerHTML="",this.winnerButton.node.classList.add("active"),this.garageButton.node.classList.remove("active")}render(){this.buttonContainer.className="page-buttons-container",this.page.className="page",this.addBtnListeners(),this.renderGarage(),this.buttonContainer.append(this.garageButton.node,this.winnerButton.node),this.page.append(this.buttonContainer,this.main),document.body.append(this.page)}}).render()})()})();